!function(){"use strict";const e={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input_error_visible"},t=document.querySelector(".edit-popup"),s=document.querySelector(".add-popup"),n=document.querySelector(".avatar-popup"),i=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__add-button"),o=document.querySelector(".profile__image-container");class a{constructor(e,t,s){let{data:n,handleCardClick:i,handleDeleteCard:r,handleCardlike:o}=e;var a,l;l=()=>{this._element.remove(),this._element=null},(a="deleteCard")in this?Object.defineProperty(this,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):this[a]=l,this._name=n.name,this._link=n.link,this._templateSelector=t,this._handleCardClick=i,this._handleDeleteCard=r,this._handleCardlike=o,this._id=n._id,this._likes=n.likes,this._userId=s,this._ownerId=n.owner._id}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".place").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._placeImage=this._element.querySelector(".place__image");const e=this._element.querySelector(".place__title");return this._likeCounter=this._element.querySelector(".place__likes-count"),this._likeButton=this._element.querySelector(".place__like-button"),this._placeImage.src=this._link,this._placeImage.alt="Photo of ".concat(this._name),e.textContent=this._name,this._element.querySelector(".place__likes-count").textContent=this._likes.length,this._userId!==this._ownerId&&(this._element.querySelector(".place__delete_button").style.display="none"),this.updateLikes(this._likes),this._setEventListeners(),this._element}_setEventListeners(){this._element.querySelector(".place__like-button").addEventListener("click",(()=>this._handleCardlike(this._id))),this._element.querySelector(".place__delete_button").addEventListener("click",(()=>this._handleDeleteCard(this._id))),this._placeImage.addEventListener("click",(()=>this._handleCardClick()))}updateLikes(e){this._likes=e,this._likeCounter.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("place__like-button_active"):this._likeButton.classList.remove("place__like-button_active")}isLiked(){return this._likes.some((e=>e._id===this._userId))}}class l{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_hasInvalidInput(){return this._inputsList.every((e=>e.validity.valid))}_toggleButton(){this._hasInvalidInput()?this._enableButton():this._disableButton()}_enableButton(){this._button.disabled=!1,this._button.classList.remove(this._inactiveButtonClass)}_disableButton(){this._button.disabled=!0,this._button.classList.add(this._inactiveButtonClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=document.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_setEventListeners(){this._inputsList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._button=this._form.querySelector(this._submitButtonSelector),this._toggleButton(),this._inputsList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}resetValidation(){this._toggleButton(),this._inputsList.forEach((e=>{this._hideInputError(e)}))}}function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c{constructor(e){h(this,"_handleEscClose",(e=>{"Escape"==e.key&&this.close()})),h(this,"_handleOverlayClick",(e=>{e.target===e.currentTarget&&this.close()})),this._popupElement=document.querySelector(e),this._submitButton=this._popupElement.querySelector(".form__button"),this._submitButton&&(this._submitButtonText=this._submitButton.textContent)}open(){this._popupElement.classList.add("popup__active"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleOverlayClick)}close(){this._popupElement.classList.remove("popup__active"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleOverlayClick)}handleLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton&&(this._submitButton.textContent=e?t:this._submitButtonText)}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("mousedown",(()=>this.close()))}}class u extends c{constructor(e,t){super(e),this._handleSubmit=t,this._inputsList=[...this._popupElement.querySelectorAll(".form__input")],this._formElement=this._popupElement.querySelector(".form")}_getInputValues(){const e={};return this._inputsList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputsList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues())})),super.setEventListeners()}close(){super.close(),this._formElement.reset()}}const _=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(e.statusText)}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}setUserInfo(e,t){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}setUserAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then(this._checkResponse)}createCard(e){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then(this._checkResponse)}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}toggleLike(e,t){let s;return s=t?"DELETE":"PUT",fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:s}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"a987f557-c5fc-4df9-a055-4063817e4bf0","Content-Type":"application/json"}});let d;Promise.all([_.getInitialCards(),_.getUserInfo()]).then((e=>{let[t,s]=e;var n;d=s._id,b.renderer(t),n=s,m.setUserInfo(n.name,n.about),m.setUserImage(n.avatar)})).catch((e=>console.log(e)));const p=e=>{const t=(e=>{const t=new a({data:e,handleCardClick:()=>g.open(e),handleDeleteCard:e=>{v.open(),v.setAction((()=>{v.handleLoading(!0,"Deleting..."),_.deleteCard(e).then((()=>{t.deleteCard(),v.close()})).catch((e=>console.log("error",e))).finally((()=>v.handleLoading(!1)))}))},handleCardlike:e=>{const s=t.isLiked();_.toggleLike(e,s).then((e=>{t.updateLikes(e.likes)})).catch((e=>console.log(e)))}},"#place-template",d);return t.generateCard()})(e);b.addItem(t)},m=new class{constructor(e){let{nameSelector:t,jobSelector:s,imageSelector:n}=e;this._userName=document.querySelector(t),this._userJob=document.querySelector(s),this._userImage=document.querySelector(n)}getUserInfo(){return{name:this._userName.textContent,job:this._userJob.textContent}}setUserInfo(e,t){this._userName.textContent=e,this._userJob.textContent=t}setUserImage(e){this._userImage.src=e}setImageVisible(){this._userImage.style.visibility="visible"}}({nameSelector:".profile__name",jobSelector:".profile__title",imageSelector:".profile__image"}),b=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderer(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:p},".places__list"),v=new class extends c{setAction(e){this._handleSubmit=e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}}(".delete-popup"),g=new class extends c{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".popup__image")}open(e){const t=this._popupElement.querySelector(".popup__caption");this._popupImage.src=e.link,this._popupImage.alt="Photo of ".concat(e.name),t.textContent=e.name,super.open()}}(".image-popup"),f=new u(".avatar-popup",(e=>{f.handleLoading(!0),_.setUserAvatar(e.avatar).then((()=>{m.setUserImage(e.avatar),f.close()})).catch((e=>console.log(e))).finally((()=>f.handleLoading(!1)))})),E=new u(".add-popup",(e=>{E.handleLoading(!0,"Creating..."),_.createCard(e).then((e=>{p(e),k.resetValidation(),E.close()})).catch((e=>console.log(e))).finally((()=>E.handleLoading(!1)))})),C=new u(".edit-popup",(e=>{C.handleLoading(!0),_.setUserInfo(e.name,e.job).then((()=>{m.setUserInfo(e.name,e.job),C.close()})).catch((e=>console.log(e))).finally((()=>C.handleLoading(!1)))})),L=new l(e,t),k=new l(e,s),y=new l(e,n);C.setEventListeners(),E.setEventListeners(),v.setEventListeners(),f.setEventListeners(),L.enableValidation(),k.enableValidation(),y.enableValidation(),i.addEventListener("click",(()=>{L.resetValidation(),C.open(),console.log(m.getUserInfo()),C.setInputValues(m.getUserInfo())})),r.addEventListener("click",(()=>{k.resetValidation(),E.open()})),o.addEventListener("click",(()=>{y.resetValidation(),f.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVFDLElBQUlKLEVBQVNsQixlQUNyQndELEVBQVUxRSxlQUFlb0MsRUFBU2xCLGtCQUdwQ2hJLEVBQWUyQyxpQkFBaUIsU0FBUyxLQUN2QzRJLEVBQXNCbkcsa0JBQ3RCa0csRUFBU3hGLFVBR1g3RixFQUFPMEMsaUJBQWlCLFNBQVMsS0FDL0IrSSxFQUFvQnRHLGtCQUNwQmlHLEVBQVl2RixVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLy0tLS0tLS0tLS0tLS0tLS1Db25zdGFudHMtLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIkFudGVsb3BlIENhbnlvblwiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTUyNzI4NTQ4OS1lZmE4ZjRlYThiMGM/aXhsaWI9cmItMS4yLjEmaXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTczNSZxPTgwXCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiU2FsdCBDcmVlayBGYWxsc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTQ5NDQ3MjE1NTY1Ni1mMzRlODFiMTdkZGM/aXhsaWI9cmItMS4yLjEmaXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTY4OCZxPTgwXCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVHJ1Y2tlZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTUxNjY4MzE3OTI4Mi1iN2Y2MDNhYjZlYmE/aXhsaWI9cmItMS4yLjEmaXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTc2NCZxPTgwXCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBQb3dlbGxcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MTY1NTcxMzk1MTAtMTM0NTBmN2QzMTI0P2l4bGliPXJiLTEuMi4xJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz02ODcmcT04MFwiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkdyYW5kIENhbnlvbiBWaWxsYWdlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNDgyNzA5NzQ2MDQxLTFhZGM1YThhZWYwMD9peGxpYj1yYi0xLjIuMSZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTE3MCZxPTgwXCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTWlhbWkgQmVhY2hcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2MDU3MjM1MTc1MDMtM2NhZGI1ODE4YTBjP2l4bGliPXJiLTEuMi4xJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xMTcwJnE9ODBcIlxyXG4gIH1cclxuXTtcclxuICBcclxuY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X2Vycm9yX3Zpc2libGVcIlxyXG59O1xyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tTW9kYWxzLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXBvcHVwXCIpO1xyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1wb3B1cFwiKTtcclxuY29uc3QgYXZhdGFyRWRpdFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hdmF0YXItcG9wdXBcIik7XHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS1CdXR0b25zLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IGFkZFBsYWNlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBhdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWNvbnRhaW5lclwiKTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgaW5pdGlhbENhcmRzLCB2YWxpZGF0aW9uU2V0dGluZ3MsIGVkaXRQcm9maWxlUG9wdXAsIGFkZENhcmRQb3B1cCxcclxuICBlZGl0UHJvZmlsZUJ1dHRvbiwgYWRkUGxhY2VCdXR0b24sIGF2YXRhciwgYXZhdGFyRWRpdFBvcHVwXHJcbn07IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7ZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDYXJkLCBoYW5kbGVDYXJkbGlrZX0sIHRlbXBsYXRlU2VsZWN0b3IsIHVzZXJJZCkge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgICAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZGxpa2UgPSBoYW5kbGVDYXJkbGlrZTtcclxuICAgICAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuXHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXHJcbiAgICAgICAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZScpLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX3BsYWNlSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX2ltYWdlXCIpO1xyXG4gICAgICAgIGNvbnN0IHBsYWNlVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX3RpdGxlXCIpO1xyXG5cclxuICAgICAgICB0aGlzLl9saWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZV9fbGlrZXMtY291bnRcIilcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlX19saWtlLWJ1dHRvblwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxhY2VJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIHRoaXMuX3BsYWNlSW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xyXG4gICAgICAgIHBsYWNlVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZV9fbGlrZXMtY291bnRcIikudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYodGhpcy5fdXNlcklkICE9PSB0aGlzLl9vd25lcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZV9fZGVsZXRlX2J1dHRvblwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMudXBkYXRlTGlrZXModGhpcy5fbGlrZXMpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUNhcmRsaWtlKHRoaXMuX2lkKSk7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlX19kZWxldGVfYnV0dG9uXCIpXHJcbiAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZCkpO1xyXG4gICAgICAgIHRoaXMuX3BsYWNlSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUNhcmRDbGljaygpKTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYXJkID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlTGlrZXMobmV3TGlrZXMpIHtcclxuICAgICAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xyXG4gICAgICAgIHRoaXMuX2xpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIGlmKHRoaXMuaXNMaWtlZCgpKSB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJwbGFjZV9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgICAgIGVsc2UgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwicGxhY2VfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0xpa2VkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChwZXJzb24pID0+IHBlcnNvbi5faWQgPT09IHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9XHJcbiAgICBcclxufSIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtVG9DaGVjaykge1xyXG4gICAgICAgIHRoaXMuX2Zvcm0gPSBmb3JtVG9DaGVjaztcclxuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgICAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIH1cclxuICAgIFxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRzTGlzdC5ldmVyeSgoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfdG9nZ2xlQnV0dG9uKCkge1xyXG4gICAgICAgIGlmKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpOyBcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9kaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dHNMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2lucHV0c0xpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4gZXZ0LnByZXZlbnREZWZhdWx0KCkpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0c0xpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh0aGlzLl9zdWJtaXRCdXR0b24pIHtcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX19hY3RpdmVcIik7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljayk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9fYWN0aXZlXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xpY2spO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgICBpZihldnQua2V5ID09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlT3ZlcmxheUNsaWNrID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgICAgIGlmICh0aGlzLl9zdWJtaXRCdXR0b24pIHtcclxuICAgICAgICAgICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIik7XHJcbiAgICAgICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlU3VibWl0KSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3RvcilcclxuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5faW5wdXRzTGlzdCA9IFsuLi50aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKV07XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuX2lucHV0c0xpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV09IGlucHV0LnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICAgIH1cclxuICAgIFxyXG4gICAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0c0xpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICAgIH1cclxufSIsImNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7YmFzZVVybCwgaGVhZGVyc30pIHtcclxuICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgICBpZihyZXMub2spIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICBlbHNlIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgICB9KSxcclxuICAgICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgYXZhdGFyOiBhdmF0YXJcclxuICAgICAgICB9KSxcclxuICAgICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgfVxyXG5cclxuICAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIlxyXG4gICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlTGlrZShjYXJkSWQsIGlzTGlrZWQpIHtcclxuICAgIGxldCBtZXRob2Q7XHJcbiAgICBpc0xpa2VkID8gKG1ldGhvZCA9IFwiREVMRVRFXCIpIDogKG1ldGhvZCA9IFwiUFVUXCIpXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IG1ldGhvZFxyXG4gICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG4gIFxyXG4gIGV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICAgIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiBcImE5ODdmNTU3LWM1ZmMtNGRmOS1hMDU1LTQwNjM4MTdlNGJmMFwiLFxyXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgfVxyXG4gIH0pOyIsIi8vLS0tLS0tLS0tLS0tLS0tLUltcG9ydHMtLS0tLS0tLS0tLS0tLS0tXHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdFByb2ZpbGVQb3B1cCwgYWRkQ2FyZFBvcHVwLFxyXG4gIGVkaXRQcm9maWxlQnV0dG9uLCBhZGRQbGFjZUJ1dHRvbiwgYXZhdGFyLCBhdmF0YXJFZGl0UG9wdXAgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanNcIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLUZ1bmN0aW9ucy0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmxldCB1c2VySWQ7XHJcblxyXG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pXHJcbiAgLnRoZW4oKFtjYXJkRGF0YSwgdXNlckRhdGFdKSA9PiB7XHJcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICBwbGFjZXNTZWN0aW9uLnJlbmRlcmVyKGNhcmREYXRhKTtcclxuICAgIGZpbGxQcm9maWxlU2VjdGlvbih1c2VyRGF0YSk7XHJcbiAgfSkuY2F0Y2gocmVzID0+IGNvbnNvbGUubG9nKHJlcykpO1xyXG5cclxuY29uc3QgZ2VuZXJhdGVDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoe1xyXG4gICAgZGF0YSwgXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IGltYWdlUG9wdXAub3BlbihkYXRhKSxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQ6IChpZCkgPT4ge1xyXG4gICAgICBkZWxldGVQb3B1cC5vcGVuKCk7XHJcbiAgICAgIGRlbGV0ZVBvcHVwLnNldEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlUG9wdXAuaGFuZGxlTG9hZGluZyh0cnVlLCBcIkRlbGV0aW5nLi4uXCIpO1xyXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGlkKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIG5ld0NhcmQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgICAgZGVsZXRlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICB9KS5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coXCJlcnJvclwiLCBlcnIpKVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4gZGVsZXRlUG9wdXAuaGFuZGxlTG9hZGluZyhmYWxzZSkpO1xyXG4gICAgICAgIFxyXG4gICAgICB9KX0sXHJcbiAgICBoYW5kbGVDYXJkbGlrZTogKGlkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGxpa2VBY3RpdmUgPSBuZXdDYXJkLmlzTGlrZWQoKTtcclxuICAgICAgaWYobGlrZUFjdGl2ZSkge1xyXG4gICAgICAgIGFwaS50b2dnbGVMaWtlKGlkLCBsaWtlQWN0aXZlKS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICBuZXdDYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgfSkuY2F0Y2gocmVzID0+IGNvbnNvbGUubG9nKHJlcykpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaS50b2dnbGVMaWtlKGlkLCBsaWtlQWN0aXZlKS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICBuZXdDYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgfSkuY2F0Y2gocmVzID0+IGNvbnNvbGUubG9nKHJlcykpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSwgXCIjcGxhY2UtdGVtcGxhdGVcIiwgdXNlcklkKTtcclxuICAgIFxyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3Q2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn07XHJcblxyXG5jb25zdCByZW5kZXJDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBjYXJkID0gZ2VuZXJhdGVDYXJkKGRhdGEpO1xyXG4gIHBsYWNlc1NlY3Rpb24uYWRkSXRlbShjYXJkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZmlsbFByb2ZpbGVTZWN0aW9uKHJlcykge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcy5uYW1lLCByZXMuYWJvdXQpO1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbWFnZShyZXMuYXZhdGFyKTtcclxufVxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tQ2xhc3NlcyBpbml0aWFsaXphdGlvbi0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGltYWdlU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCJcclxufSk7XHJcblxyXG5jb25zdCBwbGFjZXNTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmRcclxuICB9LFxyXG4gIFwiLnBsYWNlc19fbGlzdFwiXHJcbik7XHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS1Qb3B1cHMtLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5kZWxldGUtcG9wdXBcIik7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLmltYWdlLXBvcHVwXCIpO1xyXG5cclxuY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5hdmF0YXItcG9wdXBcIiwgKGRhdGEpID0+IHtcclxuICBhdmF0YXJQb3B1cC5oYW5kbGVMb2FkaW5nKHRydWUpXHJcbiAgYXBpLnNldFVzZXJBdmF0YXIoZGF0YS5hdmF0YXIpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbWFnZShkYXRhLmF2YXRhcik7XHJcbiAgICAgIGF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KS5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IGF2YXRhclBvcHVwLmhhbmRsZUxvYWRpbmcoZmFsc2UpKTtcclxufSk7XHJcblxyXG5jb25zdCBhZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLmFkZC1wb3B1cFwiLCAoZGF0YSkgPT4ge1xyXG4gIGFkZFBvcHVwLmhhbmRsZUxvYWRpbmcodHJ1ZSwgXCJDcmVhdGluZy4uLlwiKTtcclxuICBhcGkuY3JlYXRlQ2FyZChkYXRhKS50aGVuKHJlcyA9PiB7XHJcbiAgICByZW5kZXJDYXJkKHJlcyk7XHJcbiAgICBhZGRQbGFjZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICBhZGRQb3B1cC5jbG9zZSgpO1xyXG4gIH0pLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gIC5maW5hbGx5KCgpID0+IGFkZFBvcHVwLmhhbmRsZUxvYWRpbmcoZmFsc2UpKTtcclxufSk7XHJcblxyXG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5lZGl0LXBvcHVwXCIsIChkYXRhKSA9PiB7XHJcbiAgZWRpdFBvcHVwLmhhbmRsZUxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpLnNldFVzZXJJbmZvKGRhdGEubmFtZSwgZGF0YS5qb2IpXHJcbiAgLnRoZW4oKCkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YS5uYW1lLCBkYXRhLmpvYik7XHJcbiAgICBlZGl0UG9wdXAuY2xvc2UoKTtcclxuICB9KS5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAuZmluYWxseSgoKSA9PiBlZGl0UG9wdXAuaGFuZGxlTG9hZGluZyhmYWxzZSkpOztcclxufSk7XHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS1Gb3JtIFZhbGlkYXRvcnMtLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBlZGl0UHJvZmlsZVBvcHVwKTtcclxuY29uc3QgYWRkUGxhY2VGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRDYXJkUG9wdXApO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhdmF0YXJFZGl0UG9wdXApO1xyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tRXZlbnQgbGlzdGVuZXJzLS0tLS0tLS0tLS0tLS0tLVxyXG5lZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRQbGFjZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLUV2ZW50IGhhbmRsZXJzLS0tLS0tLS0tLS0tLS0tLVxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRQb3B1cC5vcGVuKCk7XHJcbiAgY29uc29sZS5sb2codXNlckluZm8uZ2V0VXNlckluZm8oKSk7XHJcbiAgZWRpdFBvcHVwLnNldElucHV0VmFsdWVzKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xyXG59KTtcclxuXHJcbmFkZFBsYWNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkUGxhY2VGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5hdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGF2YXRhclBvcHVwLm9wZW4oKTtcclxufSk7IiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yICh7bmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgaW1hZ2VTZWxlY3Rvcn0pIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl91c2VySm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fdXNlckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpbWFnZVNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgam9iOiB0aGlzLl91c2VySm9iLnRleHRDb250ZW50XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyhuYW1lLCBqb2IpIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fdXNlckpvYi50ZXh0Q29udGVudCA9IGpvYjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW1hZ2UoaW1hZ2UpIHtcclxuICAgICAgICB0aGlzLl91c2VySW1hZ2Uuc3JjID0gaW1hZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SW1hZ2VWaXNpYmxlKCkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJJbWFnZS5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7cmVuZGVyZXJ9LCBjbGFzc1NlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNsYXNzU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcmVyKGl0ZW1zKSB7XHJcbiAgICAgICAgaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdFN1Ym1pdCBleHRlbmRzIFBvcHVwe1xyXG4gICAgc2V0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3RvcilcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oZGF0YSkge1xyXG4gICAgICAgIGNvbnN0IGltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xyXG5cclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9ICBgUGhvdG8gb2YgJHtkYXRhLm5hbWV9YDtcclxuICAgICAgICBpbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59Il0sIm5hbWVzIjpbInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZWRpdFByb2ZpbGVQb3B1cCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZENhcmRQb3B1cCIsImF2YXRhckVkaXRQb3B1cCIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkUGxhY2VCdXR0b24iLCJhdmF0YXIiLCJDYXJkIiwiY29uc3RydWN0b3IiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwidXNlcklkIiwiZGF0YSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVDYXJkbGlrZSIsInRoaXMiLCJfZWxlbWVudCIsInJlbW92ZSIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2hhbmRsZUNhcmRsaWtlIiwiX2lkIiwiX2xpa2VzIiwibGlrZXMiLCJfdXNlcklkIiwiX293bmVySWQiLCJvd25lciIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJfcGxhY2VJbWFnZSIsInBsYWNlVGl0bGUiLCJfbGlrZUNvdW50ZXIiLCJfbGlrZUJ1dHRvbiIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwibGVuZ3RoIiwic3R5bGUiLCJkaXNwbGF5IiwidXBkYXRlTGlrZXMiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwibmV3TGlrZXMiLCJpc0xpa2VkIiwiY2xhc3NMaXN0IiwiYWRkIiwic29tZSIsInBlcnNvbiIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1Ub0NoZWNrIiwiX2Zvcm0iLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dHNMaXN0IiwiZXZlcnkiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3RvZ2dsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfZGlzYWJsZUJ1dHRvbiIsIl9idXR0b24iLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbnB1dCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIl9wb3B1cEVsZW1lbnQiLCJfc3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX2hhbmRsZU92ZXJsYXlDbGljayIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJoYW5kbGVMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfZm9ybUVsZW1lbnQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJlIiwicmVzZXQiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRVc2VyQXZhdGFyIiwiY3JlYXRlQ2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJ0b2dnbGVMaWtlIiwiYXV0aG9yaXphdGlvbiIsImFsbCIsImNhcmREYXRhIiwidXNlckRhdGEiLCJwbGFjZXNTZWN0aW9uIiwicmVuZGVyZXIiLCJ1c2VySW5mbyIsInNldFVzZXJJbWFnZSIsImNhdGNoIiwiY29uc29sZSIsImxvZyIsInJlbmRlckNhcmQiLCJjYXJkIiwibmV3Q2FyZCIsImltYWdlUG9wdXAiLCJkZWxldGVQb3B1cCIsInNldEFjdGlvbiIsImVyciIsImZpbmFsbHkiLCJsaWtlQWN0aXZlIiwiYWRkSXRlbSIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiaW1hZ2VTZWxlY3RvciIsIl91c2VyTmFtZSIsIl91c2VySm9iIiwiX3VzZXJJbWFnZSIsImpvYiIsImltYWdlIiwic2V0SW1hZ2VWaXNpYmxlIiwidmlzaWJpbGl0eSIsImNsYXNzU2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbXMiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJhY3Rpb24iLCJfcG9wdXBJbWFnZSIsImltYWdlQ2FwdGlvbiIsImF2YXRhclBvcHVwIiwiYWRkUG9wdXAiLCJhZGRQbGFjZUZvcm1WYWxpZGF0b3IiLCJlZGl0UG9wdXAiLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9