!function(){"use strict";const e={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input_error_visible"},t=document.querySelector(".edit-popup"),s=document.querySelector(".add-popup"),n=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button"),o=t.querySelector(".form__input[name='name']"),r=t.querySelector(".form__input[name='title']");function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class a{constructor(e,t,s){l(this,"_handlePlaceDelete",(()=>{this._element.remove(),this._element=null})),l(this,"_toggleCardLike",(()=>{this._element.querySelector(".place__like-button").classList.toggle("place__like-button_active")})),this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".place").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._placeImage=this._element.querySelector(".place__image");const e=this._element.querySelector(".place__title");return this._placeImage.src=this._link,this._placeImage.alt="Photo of ".concat(this._name),e.textContent=this._name,this._setEventListeners(),this._element}_setEventListeners(){const e=this._element.querySelector(".place__like-button"),t=this._element.querySelector(".place__delete_button");e.addEventListener("click",this._toggleCardLike),t.addEventListener("click",(()=>this._handlePlaceDelete())),this._placeImage.addEventListener("click",(()=>this._handleCardClick()))}}class u{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_hasInvalidInput(){return this._inputsList.every((e=>e.validity.valid))}_toggleButton(){this._hasInvalidInput()?this._enableButton():this._disableButton()}_enableButton(){this._button.disabled=!1,this._button.classList.remove(this._inactiveButtonClass)}_disableButton(){this._button.disabled=!0,this._button.classList.add(this._inactiveButtonClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=document.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_setEventListeners(){this._inputsList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._button=this._form.querySelector(this._submitButtonSelector),this._toggleButton(),this._inputsList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}resetValidation(){this._toggleButton(),this._inputsList.forEach((e=>{this._hideInputError(e)}))}}function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class p{constructor(e){c(this,"_handleEscClose",(e=>{"Escape"==e.key&&this.close()})),c(this,"_handleOverlayClick",(e=>{e.target===e.currentTarget&&this.close()})),this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("popup__active"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleOverlayClick)}close(){this._popupElement.classList.remove("popup__active"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleOverlayClick)}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("mousedown",(()=>this.close()))}}class _ extends p{constructor(e,t){super(e),this._handleSubmit=t}_getInputValues(){this._inputsList=[...this._popupElement.querySelectorAll(".form__input")];const e={};return this._inputsList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues()),this.close(),this._popupElement.querySelector(".form").reset()})),super.setEventListeners()}close(){super.close()}}const h=e=>{const t=(e=>new a(e,"#place-template",(()=>b.open(e.link,e.name))).generateCard())(e);d.addItem(t)},d=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderer(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Antelope Canyon",link:"https://images.unsplash.com/photo-1527285489-efa8f4ea8b0c?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=735&q=80"},{name:"Salt Creek Falls",link:"https://images.unsplash.com/photo-1494472155656-f34e81b17ddc?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=688&q=80"},{name:"Truckee",link:"https://images.unsplash.com/photo-1516683179282-b7f603ab6eba?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=764&q=80"},{name:"Lake Powell",link:"https://images.unsplash.com/photo-1516557139510-13450f7d3124?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=687&q=80"},{name:"Grand Canyon Village",link:"https://images.unsplash.com/photo-1482709746041-1adc5a8aef00?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80"},{name:"Miami Beach",link:"https://images.unsplash.com/photo-1605723517503-3cadb5818a0c?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80"}],renderer:h},".places__list"),m=new _(".edit-popup",(e=>y.setUserInfo(e.name,e.title))),f=new _(".add-popup",(e=>{h(e),E.resetValidation()})),b=new class extends p{constructor(e){super(e)}open(e,t){this._popupImage=this._popupElement.querySelector(".popup__image");const s=this._popupElement.querySelector(".popup__caption");this._popupImage.src=e,this._popupImage.alt="Photo of ".concat(t),s.textContent=t,super.setEventListeners(),super.open()}}(".image-popup"),v=new u(e,t),E=new u(e,s),y=new class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._userName=document.querySelector(t),this._userJob=document.querySelector(s)}getUserInfo(){return{name:this._userName.textContent,job:this._userJob.textContent}}setUserInfo(e,t){this._userName.textContent=e,this._userJob.textContent=t}}({nameSelector:".profile__name",jobSelector:".profile__title"});d.renderer(),m.setEventListeners(),f.setEventListeners(),v.enableValidation(),E.enableValidation(),n.addEventListener("click",(()=>{v.resetValidation(),m.open(),(()=>{const e=y.getUserInfo();o.value=e.name,r.value=e.job})()})),i.addEventListener("click",(()=>{E.resetValidation(),f.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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K0csU0FBUzVGLFlBQWM4RixJSGlDTixDQUM1QkwsYUFBYyxpQkFDZEMsWUFBYSxvQkFJZnZCLEVBQWNJLFdBQ2RPLEVBQVV4QixvQkFDVjRCLEVBQVM1QixvQkFDVGtDLEVBQXFCakQsbUJBQ3JCNEMsRUFBc0I1QyxtQkFHdEJuRSxFQUFrQmdDLGlCQUFpQixTQUFTLEtBQzFDb0YsRUFBcUI5QyxrQkFDckJvQyxFQUFVNUIsT0F4Q1ksTUFDdEIsTUFBTTZDLEVBQU9oQixFQUFTYyxjQUN0QnZILEVBQWF1RixNQUFRa0MsRUFBSzVHLEtBQzFCWixFQUFjc0YsTUFBUWtDLEVBQUtELEtBc0MzQkUsTUFHRjNILEVBQWUrQixpQkFBaUIsU0FBUyxLQUN2QytFLEVBQXNCekMsa0JBQ3RCd0MsRUFBU2hDLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8tLS0tLS0tLS0tLS0tLS0tQ29uc3RhbnRzLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJBbnRlbG9wZSBDYW55b25cIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MjcyODU0ODktZWZhOGY0ZWE4YjBjP2l4bGliPXJiLTEuMi4xJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03MzUmcT04MFwiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlNhbHQgQ3JlZWsgRmFsbHNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE0OTQ0NzIxNTU2NTYtZjM0ZTgxYjE3ZGRjP2l4bGliPXJiLTEuMi4xJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz02ODgmcT04MFwiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlRydWNrZWVcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MTY2ODMxNzkyODItYjdmNjAzYWI2ZWJhP2l4bGliPXJiLTEuMi4xJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03NjQmcT04MFwiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgUG93ZWxsXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTE2NTU3MTM5NTEwLTEzNDUwZjdkMzEyND9peGxpYj1yYi0xLjIuMSZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9Njg3JnE9ODBcIlxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJHcmFuZCBDYW55b24gVmlsbGFnZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTQ4MjcwOTc0NjA0MS0xYWRjNWE4YWVmMDA/aXhsaWI9cmItMS4yLjEmaXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTExNzAmcT04MFwiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIk1pYW1pIEJlYWNoXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjA1NzIzNTE3NTAzLTNjYWRiNTgxOGEwYz9peGxpYj1yYi0xLjIuMSZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTE3MCZxPTgwXCJcclxuICB9XHJcbl07XHJcbiAgXHJcbmNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF9lcnJvcl92aXNpYmxlXCJcclxufTtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLU1vZGFscy0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1wb3B1cFwiKTtcclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtcG9wdXBcIik7XHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS1CdXR0b25zLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IGFkZFBsYWNlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tSW5wdXRzLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBuZXdOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRbbmFtZT0nbmFtZSddXCIpO1xyXG5jb25zdCBuZXdUaXRsZUlucHV0ID0gZWRpdFByb2ZpbGVQb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0W25hbWU9J3RpdGxlJ11cIik7XHJcblxyXG5leHBvcnQge1xyXG4gIGluaXRpYWxDYXJkcywgdmFsaWRhdGlvblNldHRpbmdzLCBlZGl0UHJvZmlsZVBvcHVwLCBhZGRDYXJkUG9wdXAsXHJcbiAgZWRpdFByb2ZpbGVCdXR0b24sIGFkZFBsYWNlQnV0dG9uLCBuZXdOYW1lSW5wdXQsIG5ld1RpdGxlSW5wdXRcclxufTsiLCJpbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaykge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgICAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZScpLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX3BsYWNlSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX2ltYWdlXCIpO1xyXG4gICAgICAgIGNvbnN0IHBsYWNlVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX3RpdGxlXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuX3BsYWNlSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICB0aGlzLl9wbGFjZUltYWdlLmFsdCA9IGBQaG90byBvZiAke3RoaXMuX25hbWV9YDtcclxuICAgICAgICBwbGFjZVRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBjb25zdCBwbGFjZUxpa2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgICAgIGNvbnN0IHBsYWNlRGVsZXRlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlX19kZWxldGVfYnV0dG9uXCIpO1xyXG5cclxuICAgICAgICBwbGFjZUxpa2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX3RvZ2dsZUNhcmRMaWtlKTtcclxuICAgICAgICBwbGFjZURlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlUGxhY2VEZWxldGUoKSk7XHJcbiAgICAgICAgdGhpcy5fcGxhY2VJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlQ2FyZENsaWNrKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVQbGFjZURlbGV0ZSA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIF90b2dnbGVDYXJkTGlrZSA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCBsaWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlX19saWtlLWJ1dHRvblwiKTtcclxuICAgICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJwbGFjZV9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gICAgXHJcbn0iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybVRvQ2hlY2spIHtcclxuICAgICAgICB0aGlzLl9mb3JtID0gZm9ybVRvQ2hlY2s7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0c0xpc3QuZXZlcnkoKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgX3RvZ2dsZUJ1dHRvbigpIHtcclxuICAgICAgICBpZih0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTsgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgICAgICB0aGlzLl9idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRzTGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKTtcclxuICAgICAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xyXG5cclxuICAgICAgICB0aGlzLl9pbnB1dHNMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiBldnQucHJldmVudERlZmF1bHQoKSk7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcbiAgICAgICAgdGhpcy5faW5wdXRzTGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX19hY3RpdmVcIik7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljayk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9fYWN0aXZlXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xpY2spO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgICBpZihldnQua2V5ID09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlT3ZlcmxheUNsaWNrID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgY29uc3QgY2xvc2VCdXR0b24gPSAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKTtcclxuXHJcbiAgICAgICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKVxyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRzTGlzdCA9IFsuLi50aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKV07XHJcbiAgICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLl9pbnB1dHNMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKS5yZXNldCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB9XHJcbn0iLCIvLy0tLS0tLS0tLS0tLS0tLS1JbXBvcnRzLS0tLS0tLS0tLS0tLS0tLVxyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdFByb2ZpbGVQb3B1cCwgYWRkQ2FyZFBvcHVwLFxyXG4gIGVkaXRQcm9maWxlQnV0dG9uLCBhZGRQbGFjZUJ1dHRvbiwgbmV3TmFtZUlucHV0LCBuZXdUaXRsZUlucHV0IH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7UG9wdXBXaXRoSW1hZ2V9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCB7UG9wdXBXaXRoRm9ybX0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgeyBVc2VySW5mb30gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLUZ1bmN0aW9ucy0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgZ2VuZXJhdGVDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoZGF0YSwgXCIjcGxhY2UtdGVtcGxhdGVcIiwgKCkgPT4gaW1hZ2VQb3B1cC5vcGVuKGRhdGEubGluaywgZGF0YS5uYW1lKSk7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXdDYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IGdlbmVyYXRlQ2FyZChkYXRhKTtcclxuICBwbGFjZXNTZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XHJcbn1cclxuXHJcbmNvbnN0IGZpbGxQcm9maWxlRm9ybSA9ICgpID0+IHtcclxuICBjb25zdCBpbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBuZXdOYW1lSW5wdXQudmFsdWUgPSBpbmZvLm5hbWU7XHJcbiAgbmV3VGl0bGVJbnB1dC52YWx1ZSA9IGluZm8uam9iO1xyXG59XHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS1DbGFzc2VzIGluaXRpYWxpemF0aW9uLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBwbGFjZXNTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICB7XHJcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmRcclxuICAgIH0sXHJcbiAgXCIucGxhY2VzX19saXN0XCJcclxuKTtcclxuXHJcbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLmVkaXQtcG9wdXBcIiwgKGRhdGEpID0+IHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEubmFtZSwgZGF0YS50aXRsZSkpO1xyXG5jb25zdCBhZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLmFkZC1wb3B1cFwiLCAoZGF0YSkgPT4ge1xyXG4gIHJlbmRlckNhcmQoZGF0YSk7XHJcbiAgYWRkUGxhY2VGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5pbWFnZS1wb3B1cFwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBlZGl0UHJvZmlsZVBvcHVwKTtcclxuY29uc3QgYWRkUGxhY2VGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRDYXJkUG9wdXApO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiXHJcbn0pO1xyXG5cclxuXHJcbnBsYWNlc1NlY3Rpb24ucmVuZGVyZXIoKTtcclxuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkUGxhY2VGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLUV2ZW50IGhhbmRsZXJzLS0tLS0tLS0tLS0tLS0tLVxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRQb3B1cC5vcGVuKCk7XHJcbiAgZmlsbFByb2ZpbGVGb3JtKCk7XHJcbn0pO1xyXG5cclxuYWRkUGxhY2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRQbGFjZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYWRkUG9wdXAub3BlbigpO1xyXG59KTsiLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7aXRlbXMsIHJlbmRlcmVyfSwgY2xhc3NTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNsYXNzU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcmVyKCkge1xyXG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICAgIH1cclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwe1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihpbWFnZSwgY2FwdGlvbikge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICAgICAgY29uc3QgaW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2NhcHRpb25cIik7XHJcblxyXG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gaW1hZ2U7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSAgYFBob3RvIG9mICR7Y2FwdGlvbn1gO1xyXG4gICAgICAgIGltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcHRpb247XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IgKHtuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yfSkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3VzZXJKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgam9iOiB0aGlzLl91c2VySm9iLnRleHRDb250ZW50XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyhuYW1lLCBqb2IpIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fdXNlckpvYi50ZXh0Q29udGVudCA9IGpvYjtcclxuICAgIH1cclxufSJdLCJuYW1lcyI6WyJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImVkaXRQcm9maWxlUG9wdXAiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRDYXJkUG9wdXAiLCJlZGl0UHJvZmlsZUJ1dHRvbiIsImFkZFBsYWNlQnV0dG9uIiwibmV3TmFtZUlucHV0IiwibmV3VGl0bGVJbnB1dCIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX2VsZW1lbnQiLCJyZW1vdmUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJfcGxhY2VJbWFnZSIsInBsYWNlVGl0bGUiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsInBsYWNlTGlrZSIsInBsYWNlRGVsZXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl90b2dnbGVDYXJkTGlrZSIsIl9oYW5kbGVQbGFjZURlbGV0ZSIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1Ub0NoZWNrIiwiX2Zvcm0iLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dHNMaXN0IiwiZXZlcnkiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3RvZ2dsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfZGlzYWJsZUJ1dHRvbiIsIl9idXR0b24iLCJkaXNhYmxlZCIsImFkZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbnB1dCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX2hhbmRsZU92ZXJsYXlDbGljayIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwiZSIsInJlc2V0IiwicmVuZGVyQ2FyZCIsImNhcmQiLCJpbWFnZVBvcHVwIiwicGxhY2VzU2VjdGlvbiIsImFkZEl0ZW0iLCJjbGFzc1NlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJlZGl0UG9wdXAiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwidGl0bGUiLCJhZGRQb3B1cCIsImFkZFBsYWNlRm9ybVZhbGlkYXRvciIsImltYWdlIiwiY2FwdGlvbiIsIl9wb3B1cEltYWdlIiwiaW1hZ2VDYXB0aW9uIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl91c2VyTmFtZSIsIl91c2VySm9iIiwiZ2V0VXNlckluZm8iLCJqb2IiLCJpbmZvIiwiZmlsbFByb2ZpbGVGb3JtIl0sInNvdXJjZVJvb3QiOiIifQ==